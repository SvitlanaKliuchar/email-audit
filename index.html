<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Marketing Audit Checklist | CRO28</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            text-align: center;
            color: white;
        }

        .logo {
            margin-bottom: 0px;
        }

        .logo img {
            max-width: 150px;
            height: auto;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
        }

        .content {
            padding: 40px;
        }

        .client-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .client-info h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-item label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .info-item input, .info-item select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        .info-item input:focus, .info-item select:focus {
            outline: none;
            border-color: #667eea;
        }

        .confidence-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: 10px;
        }

        .confidence-high {
            background: #d1fae5;
            color: #065f46;
        }

        .confidence-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .confidence-low {
            background: #fee2e2;
            color: #991b1b;
        }

        .section {
            margin-bottom: 35px;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .section-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            margin-right: 12px;
        }

        .section-title {
            font-size: 20px;
            color: #1a1a1a;
            font-weight: 700;
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: background 0.2s ease;
        }

        .checklist-item:hover {
            background: #f8f9fa;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            margin-right: 15px;
            min-width: 80px;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #667eea;
            margin-right: 8px;
        }

        .status-label {
            font-size: 11px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
        }

        .item-content {
            flex: 1;
        }

        .item-title {
            font-size: 15px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .item-description {
            font-size: 13px;
            color: #666;
            line-height: 1.5;
        }

        .save-status {
            text-align: center;
            margin-top: 15px;
            color: #22c55e;
            font-size: 14px;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .whats-working {
            background: #f0fdf4;
            padding: 0;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px solid #22c55e;
            overflow: hidden;
        }

        .working-header {
            padding: 20px 30px 10px;
            font-size: 18px;
            font-weight: 700;
            color: #166534;
        }

        .working-list {
            padding: 0 30px 20px;
        }

        .working-item {
            padding: 10px 0;
            color: #166534;
            font-size: 14px;
            line-height: 1.5;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .working-item:before {
            content: "✓";
            color: #22c55e;
            font-weight: bold;
            font-size: 18px;
        }

        .score-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 15px;
            color: white;
            margin-top: 30px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .score-item {
            text-align: center;
        }

        .score-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .score-label {
            font-size: 13px;
            opacity: 0.9;
        }

        .recommendations {
            background: #fff;
            padding: 0;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px solid #e0e0e0;
            overflow: hidden;
        }

        .opportunity-callout {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .opportunity-label {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            opacity: 0.95;
            font-weight: 600;
        }

        .opportunity-amount {
            font-size: 56px;
            font-weight: 900;
            margin-bottom: 8px;
            line-height: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .opportunity-annual {
            font-size: 18px;
            opacity: 0.9;
        }

        .priority-header {
            padding: 20px 30px 10px;
            font-size: 16px;
            font-weight: 700;
            color: #333;
        }

        .priority-list {
            padding: 0 30px 30px;
        }

        .priority-item {
            padding: 15px 0;
            color: #333;
            font-size: 15px;
            line-height: 1.5;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .priority-item:last-child {
            border-bottom: none;
        }

        .priority-icon {
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            margin-top: 2px;
        }

        .priority-text {
            flex: 1;
            color: #333;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 16px 24px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: white;
            color: #333;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .calculation-note {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 13px;
            color: #666;
            line-height: 1.5;
        }

        .calculation-note strong {
            color: #333;
        }

        .warning-banner {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 13px;
            color: #92400e;
            line-height: 1.5;
        }

        .warning-banner strong {
            color: #78350f;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            .action-buttons {
                display: none;
            }
        }

        @media (max-width: 600px) {
            .content {
                padding: 20px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .section-title {
                font-size: 18px;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <img src="https://147118294.fs1.hubspotusercontent-eu1.net/hubfs/147118294/Untitled%20design-2.png" alt="CRO28 Logo">
            </div>
            <h1>Email Marketing Audit</h1>
            <p>17-Point Analysis for Alcohol Brands</p>
        </div>

        <div class="content">
            <div class="client-info">
                <h3>Client Information</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <label>Brand Name</label>
                        <input type="text" placeholder="Enter brand name" id="brandName">
                    </div>
                    <div class="info-item">
                        <label>Contact Person</label>
                        <input type="text" placeholder="Enter name" id="contactPerson">
                    </div>
                    <div class="info-item">
                        <label>Audit Date</label>
                        <input type="date" id="auditDate">
                    </div>
                    <div class="info-item">
                        <label>Currency</label>
                        <select id="currency">
                            <option value="USD">USD ($)</option>
                            <option value="GBP">GBP (£)</option>
                        </select>
                    </div>
                    <div class="info-item">
                        <label>Email List Size</label>
                        <input type="number" placeholder="0" id="listSize">
                    </div>
                    <div class="info-item">
                        <label>Monthly Revenue</label>
                        <input type="text" placeholder="0" id="monthlyRevenue">
                    </div>
                    <div class="info-item">
                        <label>Current Email Platform</label>
                        <input type="text" placeholder="Klaviyo, Mailchimp, etc." id="emailPlatform">
                    </div>
                </div>
            </div>

            <!-- SECTION 1: LIST GROWTH -->
            <div class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title">List Growth Strategy (7 tactics)</div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item1">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Pop-up with real offer</div>
                        <div class="item-description">Do you have a pop-up? Does it offer real value (10% off, free guide)?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item2">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Product pages as lead magnets</div>
                        <div class="item-description">Are there email capture forms on your product pages?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item3">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Giveaways requiring email entry</div>
                        <div class="item-description">Do you run contests/giveaways that collect emails?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item4">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">QR codes on packaging/receipts</div>
                        <div class="item-description">Are you using QR codes to capture emails offline?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item5">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Social DM-to-signup automation</div>
                        <div class="item-description">Do you use "DM to join" tactics with automation (ManyChat)?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item6">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Pinned social post with freebie</div>
                        <div class="item-description">Do you have a pinned post offering a lead magnet (guide, recipes)?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item7">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Email signature CTA</div>
                        <div class="item-description">Does your team use email signatures with signup CTAs?</div>
                    </div>
                </div>
            </div>

            <!-- SECTION 2: EMAIL TACTICS -->
            <div class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title">High-Impact Email Tactics (5 types)</div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item8">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">"Meet the Maker" welcome email</div>
                        <div class="item-description">Does your welcome series include personal story/founder intro?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item9">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Email-only flash sales</div>
                        <div class="item-description">Do you run exclusive promos for subscribers?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item10">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Content emails (Top 3 lists, pairings)</div>
                        <div class="item-description">Do you send educational/content emails beyond promos?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item11">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Plain-text emails</div>
                        <div class="item-description">Do you use personal, plain-text format sometimes?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item12">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Smart P.S. with referral/social proof</div>
                        <div class="item-description">Do your emails have strategic P.S. lines?</div>
                    </div>
                </div>
            </div>

            <!-- SECTION 3: AUTOMATIONS -->
            <div class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title">Automations That Drive Revenue (4 flows)</div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item13">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Abandoned cart email series</div>
                        <div class="item-description">Do you have automated cart recovery? How many emails?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item14">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Birthday email with discount</div>
                        <div class="item-description">Do you automatically send birthday offers?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item15">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Win-back email for lapsed customers</div>
                        <div class="item-description">Do you have a re-engagement series for inactive subscribers?</div>
                    </div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item16">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Post-purchase thank you + referral</div>
                        <div class="item-description">Do you have automated post-purchase emails with referral incentive?</div>
                    </div>
                </div>
            </div>

            <!-- SECTION 4: WEEKLY CONSISTENCY -->
            <div class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title">Weekly Email Consistency</div>
                </div>

                <div class="checklist-item">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="item17">
                        <span class="status-label">Yes/No</span>
                    </div>
                    <div class="item-content">
                        <div class="item-title">Regular weekly email cadence</div>
                        <div class="item-description">Do you send consistent weekly emails? What's the format?</div>
                    </div>
                </div>
            </div>

            <!-- SCORE SECTION -->
            <div class="score-section">
                <h3 style="text-align: center; margin-bottom: 10px;">
                    Audit Score
                    <span class="confidence-badge" id="confidenceBadge" style="background: #e0e7ff; color: #3730a3;">Enter data</span>
                </h3>
                <div class="score-grid">
                    <div class="score-item">
                        <div class="score-value" id="totalScore">0/17</div>
                        <div class="score-label">Total Score</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value" id="listScore">0/7</div>
                        <div class="score-label">List Growth</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value" id="tacticsScore">0/5</div>
                        <div class="score-label">Email Tactics</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value" id="automationScore">0/4</div>
                        <div class="score-label">Automations</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value" id="consistencyScore">0/1</div>
                        <div class="score-label">Consistency</div>
                    </div>
                </div>
            </div>

            <!-- WHAT'S WORKING -->
            <div class="whats-working" id="whatsWorking" style="display: none;">
                <div class="working-header">What's Working</div>
                <div class="working-list" id="workingList"></div>
            </div>

            <!-- RECOMMENDATIONS -->
            <div class="recommendations">
                <div class="opportunity-callout">
                    <div class="opportunity-label">Estimated Monthly Opportunity</div>
                    <div class="opportunity-amount" id="opportunityAmount">$0</div>
                    <div class="opportunity-annual"><span id="annualAmount">$0</span>/year potential</div>
                </div>
                <div class="priority-header">Priority Recommendations</div>
                <div class="priority-list" id="recommendationsList">
                    <div class="priority-item">
                        <div class="priority-text">Complete the audit to see recommendations</div>
                    </div>
                </div>
            </div>

            <div id="warningBanner" style="display: none;"></div>

            <div class="calculation-note">
                <strong>Methodology:</strong> We estimate your current email performance based on your audit score, then compare it to conservative industry benchmarks for alcohol brands (20-30% of DTC revenue). The gap represents your improvement opportunity. Recommendations are allocated proportionally without double-counting. <strong>Note:</strong> These are directional estimates based on industry averages, not guarantees. Actual results vary by brand, market, and execution.
            </div>

            <!-- ACTION BUTTONS -->
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="copyAuditSummary()">Copy Summary</button>
                <button class="btn btn-secondary" onclick="downloadJSON()">Download JSON</button>
                <button class="btn btn-secondary" onclick="window.print()">Print / Save PDF</button>
            </div>

            <div class="save-status" id="saveStatus"></div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'email_audit_data_v2';

        // Currency symbols and conversion rates (for display purposes)
        const CURRENCY_CONFIG = {
            USD: { symbol: '$', position: 'before' },
            GBP: { symbol: '£', position: 'before' }
        };

        // Set today's date by default
        document.getElementById('auditDate').valueAsDate = new Date();

        // Load saved data on page load
        window.addEventListener('load', function() {
            loadAuditData();
            calculateScore();
        });

        // Auto-save and auto-calculate whenever any input changes
        document.addEventListener('change', function(e) {
            if (e.target.matches('input[type="checkbox"], input[type="text"], input[type="number"], input[type="date"], select, textarea')) {
                saveAuditData();
                calculateScore();
            }
        });

        // Also listen to input events for real-time calculation
        document.addEventListener('input', function(e) {
            if (e.target.matches('input[type="number"], input[type="text"]')) {
                calculateScore();
            }
        });

        function formatCurrency(amount, currencyCode) {
            const config = CURRENCY_CONFIG[currencyCode] || CURRENCY_CONFIG.USD;
            const formatted = Math.round(amount).toLocaleString();
            return config.position === 'before' ? `${config.symbol}${formatted}` : `${formatted}${config.symbol}`;
        }

        function saveAuditData() {
            const data = {
                clientInfo: {
                    brandName: document.getElementById('brandName').value,
                    contactPerson: document.getElementById('contactPerson').value,
                    auditDate: document.getElementById('auditDate').value,
                    currency: document.getElementById('currency').value,
                    emailListSize: document.getElementById('listSize').value,
                    monthlyRevenue: document.getElementById('monthlyRevenue').value,
                    emailPlatform: document.getElementById('emailPlatform').value
                },
                checkboxes: Array.from(document.querySelectorAll('input[type="checkbox"]')).map(cb => cb.checked),
                timestamp: new Date().toISOString()
            };

            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            showSaveStatus('✓ Saved');
        }

        function loadAuditData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (!saved) return;

            try {
                const data = JSON.parse(saved);
                
                // Load client info
                if (data.clientInfo.brandName) document.getElementById('brandName').value = data.clientInfo.brandName;
                if (data.clientInfo.contactPerson) document.getElementById('contactPerson').value = data.clientInfo.contactPerson;
                if (data.clientInfo.auditDate) document.getElementById('auditDate').value = data.clientInfo.auditDate;
                if (data.clientInfo.currency) document.getElementById('currency').value = data.clientInfo.currency;
                if (data.clientInfo.emailListSize) document.getElementById('listSize').value = data.clientInfo.emailListSize;
                if (data.clientInfo.monthlyRevenue) document.getElementById('monthlyRevenue').value = data.clientInfo.monthlyRevenue;
                if (data.clientInfo.emailPlatform) document.getElementById('emailPlatform').value = data.clientInfo.emailPlatform;

                // Load checkboxes
                const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                data.checkboxes.forEach((checked, index) => {
                    if (checkboxes[index]) checkboxes[index].checked = checked;
                });

                showSaveStatus('✓ Loaded previous audit');
            } catch (e) {
                console.error('Error loading saved data:', e);
            }
        }

        function showSaveStatus(message) {
            const status = document.getElementById('saveStatus');
            status.textContent = message;
            status.style.opacity = '1';
            setTimeout(() => {
                status.style.opacity = '0';
            }, 2000);
        }

        function copyAuditSummary() {
            const currency = document.getElementById('currency').value;
            const brandName = document.getElementById('brandName').value || 'Client';
            const auditDate = document.getElementById('auditDate').value || new Date().toISOString().split('T')[0];
            const totalScore = document.getElementById('totalScore').textContent;
            const listScore = document.getElementById('listScore').textContent;
            const tacticsScore = document.getElementById('tacticsScore').textContent;
            const automationScore = document.getElementById('automationScore').textContent;
            const consistencyScore = document.getElementById('consistencyScore').textContent;
            const opportunity = document.getElementById('opportunityAmount').textContent;
            const annual = document.getElementById('annualAmount').textContent;

            const recommendations = Array.from(document.querySelectorAll('.priority-text'))
                .map(el => '- ' + el.textContent)
                .join('\n');

            const summary = `${brandName} - Email Audit Results
Date: ${auditDate}
Currency: ${currency}

SCORES:
Total: ${totalScore}
- List Growth: ${listScore}
- Email Tactics: ${tacticsScore}
- Automations: ${automationScore}
- Consistency: ${consistencyScore}

OPPORTUNITY:
Monthly: ${opportunity}
Annual: ${annual}

TOP PRIORITIES:
${recommendations}

---
Generated by CRO28 Email Audit Tool
Note: Estimates based on conservative industry benchmarks`;

            navigator.clipboard.writeText(summary).then(() => {
                showSaveStatus('✓ Summary copied to clipboard!');
            }).catch(err => {
                alert('Could not copy to clipboard. Please copy manually.');
                console.error('Copy failed:', err);
            });
        }

        function downloadJSON() {
            const brandName = document.getElementById('brandName').value || 'Client';
            const currency = document.getElementById('currency').value;
            const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            const listCheckboxes = Array.from(allCheckboxes).slice(0, 7);
            const tacticsCheckboxes = Array.from(allCheckboxes).slice(7, 12);
            const automationCheckboxes = Array.from(allCheckboxes).slice(12, 16);
            const consistencyCheckboxes = Array.from(allCheckboxes).slice(16, 17);

            const data = {
                brand: brandName,
                date: new Date().toISOString(),
                currency: currency,
                clientInfo: {
                    brandName: document.getElementById('brandName').value,
                    contactPerson: document.getElementById('contactPerson').value,
                    auditDate: document.getElementById('auditDate').value,
                    currency: currency,
                    emailListSize: document.getElementById('listSize').value,
                    monthlyRevenue: document.getElementById('monthlyRevenue').value,
                    emailPlatform: document.getElementById('emailPlatform').value
                },
                scores: {
                    total: listCheckboxes.filter(cb => cb.checked).length + tacticsCheckboxes.filter(cb => cb.checked).length + automationCheckboxes.filter(cb => cb.checked).length + consistencyCheckboxes.filter(cb => cb.checked).length,
                    listGrowth: listCheckboxes.filter(cb => cb.checked).length,
                    emailTactics: tacticsCheckboxes.filter(cb => cb.checked).length,
                    automations: automationCheckboxes.filter(cb => cb.checked).length,
                    consistency: consistencyCheckboxes.filter(cb => cb.checked).length
                },
                opportunity: {
                    monthly: document.getElementById('opportunityAmount').textContent,
                    annual: document.getElementById('annualAmount').textContent
                },
                recommendations: Array.from(document.querySelectorAll('.priority-text')).map(el => el.textContent),
                checklist: {
                    listGrowth: listCheckboxes.map((cb, i) => ({
                        item: cb.parentElement.parentElement.querySelector('.item-title').textContent,
                        checked: cb.checked
                    })),
                    emailTactics: tacticsCheckboxes.map((cb, i) => ({
                        item: cb.parentElement.parentElement.querySelector('.item-title').textContent,
                        checked: cb.checked
                    })),
                    automations: automationCheckboxes.map((cb, i) => ({
                        item: cb.parentElement.parentElement.querySelector('.item-title').textContent,
                        checked: cb.checked
                    })),
                    consistency: consistencyCheckboxes.map((cb, i) => ({
                        item: cb.parentElement.parentElement.querySelector('.item-title').textContent,
                        checked: cb.checked
                    }))
                },
                disclaimer: "Estimates based on conservative industry benchmarks. Actual results vary by brand."
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${brandName.replace(/\s+/g, '-')}-email-audit-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSaveStatus('✓ JSON downloaded!');
        }

        function getTotalScore() {
            return Array.from(document.querySelectorAll('input[type="checkbox"]')).filter(cb => cb.checked).length;
        }

        function getListScore() {
            const checkboxes = Array.from(document.querySelectorAll('input[type="checkbox"]')).slice(0, 7);
            return checkboxes.filter(cb => cb.checked).length;
        }

        function getTacticsScore() {
            const checkboxes = Array.from(document.querySelectorAll('input[type="checkbox"]')).slice(7, 12);
            return checkboxes.filter(cb => cb.checked).length;
        }

        function getAutomationScore() {
            const checkboxes = Array.from(document.querySelectorAll('input[type="checkbox"]')).slice(12, 16);
            return checkboxes.filter(cb => cb.checked).length;
        }

        function getConsistencyScore() {
            const checkboxes = Array.from(document.querySelectorAll('input[type="checkbox"]')).slice(16, 17);
            return checkboxes.filter(cb => cb.checked).length;
        }

        function parseRevenue(revenueString) {
            if (!revenueString) return 0;
            return parseFloat(revenueString.replace(/[£$,]/g, '')) || 0;
        }

        function validateInputs(listSize, monthlyRevenue) {
            const warnings = [];
            
            // Check for unrealistic revenue per subscriber
            if (listSize > 0 && monthlyRevenue > 0) {
                const revenuePerSub = monthlyRevenue / listSize;
                
                // Flag if revenue per subscriber is extremely high (over $50/month)
                if (revenuePerSub > 50) {
                    warnings.push("Revenue per subscriber seems unusually high. Please verify your monthly revenue figure.");
                }
                
                // Flag if revenue per subscriber is extremely low (under $0.10/month)
                if (revenuePerSub < 0.1) {
                    warnings.push("Revenue per subscriber seems unusually low. This may indicate email isn't being tracked properly.");
                }
            }
            
            // Check for suspiciously small list with high revenue
            if (listSize > 0 && listSize < 500 && monthlyRevenue > 100000) {
                warnings.push("Very high revenue with small list size. Please confirm these figures are accurate.");
            }
            
            return warnings;
        }

        function showWarnings(warnings) {
            const banner = document.getElementById('warningBanner');
            if (warnings.length > 0) {
                banner.className = 'warning-banner';
                banner.style.display = 'block';
                banner.innerHTML = '<strong>⚠️ Please Review:</strong><br>' + warnings.map(w => '• ' + w).join('<br>');
            } else {
                banner.style.display = 'none';
            }
        }

        function calculateScore() {
            // Calculate scores
            const listScore = getListScore();
            const tacticsScore = getTacticsScore();
            const automationScore = getAutomationScore();
            const consistencyScore = getConsistencyScore();
            const totalScore = getTotalScore();

            // Update display
            document.getElementById('totalScore').textContent = `${totalScore}/17`;
            document.getElementById('listScore').textContent = `${listScore}/7`;
            document.getElementById('tacticsScore').textContent = `${tacticsScore}/5`;
            document.getElementById('automationScore').textContent = `${automationScore}/4`;
            document.getElementById('consistencyScore').textContent = `${consistencyScore}/1`;

            // Get inputs
            const currency = document.getElementById('currency').value;
            const listSize = parseInt(document.getElementById('listSize').value) || 0;
            const monthlyRevenue = parseRevenue(document.getElementById('monthlyRevenue').value);

            // Validate inputs and show warnings if needed
            const warnings = validateInputs(listSize, monthlyRevenue);
            showWarnings(warnings);

            // Determine confidence level
            let confidenceLevel = 'low';
            let confidenceText = 'Limited data';
            
            if (monthlyRevenue > 0 && listSize > 1000) {
                confidenceLevel = 'high';
                confidenceText = 'High confidence';
            } else if (monthlyRevenue > 0 || listSize > 500) {
                confidenceLevel = 'medium';
                confidenceText = 'Medium confidence';
            }

            const badge = document.getElementById('confidenceBadge');
            badge.className = 'confidence-badge confidence-' + confidenceLevel;
            badge.textContent = confidenceText;

            // Generate recommendations with safer calculations
            generateRecommendations(listScore, tacticsScore, automationScore, consistencyScore, totalScore, listSize, monthlyRevenue, currency, confidenceLevel);
        }

        function getIcon(type) {
            const icons = {
                'cart': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>',
                'automation': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8M12 17v4"/></svg>',
                'popup': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/></svg>',
                'email': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>',
                'variety': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg>',
                'qr': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>',
                'growth': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#ff6b6b" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>',
                'check': '<svg class="priority-icon" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>'
            };
            return icons[type] || icons['check'];
        }

        function generateRecommendations(list, tactics, automation, consistency, total, listSize, monthlyRevenue, currency, confidenceLevel) {
            const recommendations = [];
            const working = [];

            // CONSERVATIVE CALCULATION MODEL - Safer benchmarks
            let monthlyOpp = 0;
            
            if (monthlyRevenue > 0) {
                // Calculate CURRENT email contribution based on audit score
                // Conservative range: 12-25% (instead of 15-30%)
                const currentEmailContribution = 0.12 + (total / 17 * 0.13);
                const currentEmailRevenue = monthlyRevenue * currentEmailContribution;
                
                // Conservative benchmark: 25-30% for well-optimized programs (instead of 35%)
                // Use 30% only for high scores, 25% for lower scores
                const bestPracticeContribution = 0.25 + (total / 17 * 0.05);
                const potentialEmailRevenue = monthlyRevenue * bestPracticeContribution;
                
                // Opportunity = gap (but cap at reasonable maximum)
                monthlyOpp = Math.max(0, potentialEmailRevenue - currentEmailRevenue);
                
                // Apply confidence multiplier - reduce estimates for lower confidence
                if (confidenceLevel === 'medium') {
                    monthlyOpp *= 0.85; // Reduce by 15%
                } else if (confidenceLevel === 'low') {
                    monthlyOpp *= 0.70; // Reduce by 30%
                }
                
            } else if (listSize > 0) {
                // Fallback: Conservative revenue per subscriber estimates
                // Current: $0.80-$2.00/month based on score (was $1.00-$2.50)
                const currentRevenuePerSub = 0.8 + (total / 17 * 1.2);
                const currentEmailRevenue = listSize * currentRevenuePerSub;
                
                // Best practice: $2.50/month (was $3.00) - more conservative
                const potentialEmailRevenue = listSize * 2.5;
                
                // Opportunity = gap
                monthlyOpp = Math.max(0, potentialEmailRevenue - currentEmailRevenue);
                
                // Apply confidence reduction for list-only data
                monthlyOpp *= 0.75; // Reduce by 25% since we don't have revenue data
                
            } else {
                // No data: Very conservative estimate
                const gapScore = 17 - total;
                monthlyOpp = gapScore * 200; // Reduced from $300 to $200 per gap
                
                // Mark as very low confidence
                monthlyOpp *= 0.6;
            }

            // Cap opportunity at reasonable maximum based on inputs
            if (monthlyRevenue > 0) {
                // Opportunity shouldn't exceed 50% of current revenue
                const maxOpp = monthlyRevenue * 0.5;
                monthlyOpp = Math.min(monthlyOpp, maxOpp);
            } else if (listSize > 0) {
                // Cap at $5/subscriber/month as absolute maximum
                const maxOpp = listSize * 5;
                monthlyOpp = Math.min(monthlyOpp, maxOpp);
            }

            const annualOpp = monthlyOpp * 12;

            // Update prominent dollar amounts with currency formatting
            document.getElementById('opportunityAmount').textContent = formatCurrency(monthlyOpp, currency);
            document.getElementById('annualAmount').textContent = formatCurrency(annualOpp, currency);

            // What's working
            if (list >= 4) working.push('Strong list growth strategy');
            if (list >= 2 && list < 4) working.push('Growing email list with multiple tactics');
            if (tactics >= 3) working.push('Sending variety of email types');
            if (automation >= 3) working.push('Strong automation setup');
            if (automation >= 2 && automation < 3) working.push('Basic automations in place');
            if (consistency >= 1) working.push('Sending emails consistently');

            // Priority recommendations - allocate proportionally
            const missingCategories = [];
            
            // Automations - highest impact
            if (automation === 0) {
                missingCategories.push({ type: 'cart', weight: 35, text: 'Implement cart abandonment + welcome series' });
            } else if (automation === 1) {
                missingCategories.push({ type: 'cart', weight: 30, text: 'Add cart abandonment or welcome series' });
            } else if (automation < 4) {
                missingCategories.push({ type: 'automation', weight: 15, text: 'Complete remaining automation flows' });
            }
            
            // Consistency - critical foundation
            if (consistency === 0) {
                missingCategories.push({ type: 'email', weight: 25, text: 'Start weekly email campaigns' });
            }
            
            // List Growth
            if (list === 0) {
                missingCategories.push({ type: 'popup', weight: 25, text: 'Implement basic list growth tactics (pop-up)' });
            } else if (list < 3) {
                missingCategories.push({ type: 'popup', weight: 18, text: 'Expand list growth strategy' });
            } else if (list < 6) {
                missingCategories.push({ type: 'growth', weight: 12, text: 'Add advanced list growth tactics' });
            }
            
            // Tactics - improves engagement
            if (tactics < 2) {
                missingCategories.push({ type: 'variety', weight: 15, text: 'Add email variety (content, plain-text, flash sales)' });
            } else if (tactics < 4) {
                missingCategories.push({ type: 'variety', weight: 10, text: 'Round out email tactics' });
            }
            
            // Advanced tactics
            if (list >= 3 && list < 7) {
                missingCategories.push({ type: 'qr', weight: 8, text: 'Add QR codes and social automation' });
            }
            
            // Calculate total weight and normalize
            const totalWeight = missingCategories.reduce((sum, cat) => sum + cat.weight, 0);
            
            if (totalWeight > 0 && monthlyOpp > 0) {
                missingCategories.forEach(cat => {
                    const percentage = cat.weight / totalWeight;
                    const value = Math.round(monthlyOpp * percentage);
                    if (value > 0) { // Only show if there's actual value
                        recommendations.push({
                            icon: cat.type,
                            text: `${cat.text} → ${formatCurrency(value, currency)}/month`
                        });
                    }
                });
            }

            // Update "What's Working" section
            const workingSection = document.getElementById('whatsWorking');
            const workingList = document.getElementById('workingList');
            
            if (working.length > 0) {
                workingSection.style.display = 'block';
                workingList.innerHTML = working.map(item => 
                    `<div class="working-item">${item}</div>`
                ).join('');
            } else {
                workingSection.style.display = 'none';
            }

            // Update recommendations list
            const recList = document.getElementById('recommendationsList');
            if (recommendations.length > 0) {
                recList.innerHTML = recommendations.map(rec => 
                    `<div class="priority-item">${getIcon(rec.icon)}<div class="priority-text">${rec.text}</div></div>`
                ).join('');
            } else {
                recList.innerHTML = `<div class="priority-item">${getIcon('check')}<div class="priority-text">Excellent email program! Focus on optimization, A/B testing, and advanced segmentation.</div></div>`;
            }
        }

        // Initial calculation on page load
        calculateScore();
    </script>
</body>
</html>
